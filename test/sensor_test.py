import pytest
import re
from bs4 import BeautifulSoup

## copy this function from sensor.py
def parse_variation(text: str):
    """Extrai a tendência e a variação em cêntimos/litro do texto."""
    tendencia = "sobe" if "subir" in text.lower() else "desce" if "descer" in text.lower() else "neutro"
    variacao = None

    match = re.search(r"\(([-+]?\d+,\d+)\s*euros?/litro\)", text)
    if match:
        variacao = match.group(1).replace(",", ".")
        try:
            variacao = float(variacao) * 100  # converte para cêntimos
        except ValueError:
            variacao = None

    return {
        "texto": text,
        "tendencia": tendencia,
        "variacao": variacao
    }

## copy this function from sensor.py
def extract_variation(html: str, fuel_type: str):
    """Extract fuel variation info from the HTML."""
    soup = BeautifulSoup(html, "html.parser")
    for h2 in soup.find_all("h2"):
        title = h2.get_text(strip=True).lower()
        p = h2.find_next("p")
        if not p:
            continue
        # Ajusta o texto, separando palavras unidas e removendo espaços extras
        text = re.sub(r'(?<=[a-záéíóú])(?=[A-ZÁÉÍÓÚ])', ' ', p.get_text(strip=True))
        text = re.sub(r'\s+', ' ', text).strip()

        expected_prefix = f"quanto sobe ou desce"
        if fuel_type in title and title.startswith(expected_prefix):
            return parse_variation(text)  # usa a função do parse.py

    return None

def test_extract_variation_subida():
    html = """
    <!doctype html><html xmlns="http://www.w3.org/1999/xhtml" lang="pt-PT" xml:lang="pt-PT"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="preconnect" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://pagead2.googlesyndication.com"><link rel="preconnect" href="https://connect.facebook.net"><link rel="preconnect" href="https://cdn.onesignal.com"><link rel="dns-prefetch" href="https://connect.facebook.net"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="dns-prefetch" href="https://cdn.onesignal.com"><title>Preço dos Combustíveis na próxima semana (1 a 7 de setembro)</title> <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PMCDDJV');</script> <style>:root{--bs-blue:#0d6efd;--bs-indigo:#6610f2;--bs-purple:#6f42c1;--bs-pink:#d63384;--bs-red:#dc3545;--bs-orange:#fd7e14;--bs-yellow:#ffc107;--bs-green:#198754;--bs-teal:#20c997;--bs-cyan:#0dcaf0;--bs-black:#000;--bs-white:#fff;--bs-gray:#6c757d;--bs-gray-dark:#343a40;--bs-gray-100:#f8f9fa;--bs-gray-200:#e9ecef;--bs-gray-300:#dee2e6;--bs-gray-400:#ced4da;--bs-gray-500:#adb5bd;--bs-gray-600:#6c757d;--bs-gray-700:#495057;--bs-gray-800:#343a40;--bs-gray-900:#212529;--bs-primary:#56983d;--bs-secondary:green;--bs-success:#198754;--bs-info:#0dcaf0;--bs-warning:#ffc107;--bs-danger:#dc3545;--bs-light:#f8f9fa;--bs-dark:#212529;--bs-primary-rgb:86,152,61;--bs-secondary-rgb:0,128,0;--bs-success-rgb:25,135,84;--bs-info-rgb:13,202,240;--bs-warning-rgb:255,193,7;--bs-danger-rgb:220,53,69;--bs-light-rgb:248,249,250;--bs-dark-rgb:33,37,41;--bs-white-rgb:255,255,255;--bs-black-rgb:0,0,0;--bs-body-color-rgb:33,37,41;--bs-body-bg-rgb:255,255,255;--bs-font-sans-serif:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue","Noto Sans","Liberation Sans",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--bs-font-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--bs-gradient:linear-gradient(180deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0));--bs-body-font-family:var(--bs-font-sans-serif);--bs-body-font-size:1rem;--bs-body-font-weight:400;--bs-body-line-height:1.5;--bs-body-color:#212529;--bs-body-bg:#fff;--bs-border-width:1px;--bs-border-style:solid;--bs-border-color:#dee2e6;--bs-border-color-translucent:rgba(0, 0, 0, 0.175);--bs-border-radius:0.375rem;--bs-border-radius-sm:0.25rem;--bs-border-radius-lg:0.5rem;--bs-border-radius-xl:1rem;--bs-border-radius-2xl:2rem;--bs-border-radius-pill:50rem;--bs-link-color:#56983d;--bs-link-hover-color:#457a31;--bs-code-color:#d63384;--bs-highlight-bg:#fff3cd}*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:var(--bs-body-font-family);font-size:var(--bs-body-font-size);font-weight:var(--bs-body-font-weight);line-height:var(--bs-body-line-height);color:var(--bs-body-color);text-align:var(--bs-body-text-align);background-color:var(--bs-body-bg);-webkit-text-size-adjust:100%}h1,h2,h3{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}p{margin-top:0;margin-bottom:1rem}ol,ul{padding-left:2rem}ol,ul{margin-top:0;margin-bottom:1rem}strong{font-weight:bolder}a{color:var(--bs-link-color);text-decoration:underline}img{vertical-align:middle}button{border-radius:0}button,input{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button{text-transform:none}[type=button],button{-webkit-appearance:button}::-moz-focus-inner{padding:0;border-style:none}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit;-webkit-appearance:button}iframe{border:0}.img-fluid{max-width:100%;height:auto}.container,.container-fluid{--bs-gutter-x:1.5rem;--bs-gutter-y:0;width:100%;padding-right:calc(var(--bs-gutter-x)*.5);padding-left:calc(var(--bs-gutter-x)*.5);margin-right:auto;margin-left:auto}@media (min-width:576px){.container{max-width:540px}}@media (min-width:768px){.container{max-width:720px}}@media (min-width:992px){.container{max-width:960px}}@media (min-width:1200px){.container{max-width:1140px}}@media (min-width:1400px){.container{max-width:1320px}}.row{--bs-gutter-x:1.5rem;--bs-gutter-y:0;display:flex;flex-wrap:wrap;margin-top:calc(-1*var(--bs-gutter-y));margin-right:calc(-.5*var(--bs-gutter-x));margin-left:calc(-.5*var(--bs-gutter-x))}.row>*{flex-shrink:0;width:100%;max-width:100%;padding-right:calc(var(--bs-gutter-x)*.5);padding-left:calc(var(--bs-gutter-x)*.5);margin-top:var(--bs-gutter-y)}.col-12{flex:0 0 auto;width:100%}@media (min-width:992px){.col-lg{flex:1 0 0%}}@media (min-width:1200px){.col-xl-3{flex:0 0 auto;width:25%}}.form-control{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;background-clip:padding-box;border:1px solid #ced4da;appearance:none;border-radius:.375rem}.form-control::-webkit-date-and-time-value{height:1.5em}.collapse:not(.show){display:none}.nav-link{display:block;padding:var(--bs-nav-link-padding-y) var(--bs-nav-link-padding-x);font-size:var(--bs-nav-link-font-size);font-weight:var(--bs-nav-link-font-weight);color:var(--bs-nav-link-color);text-decoration:none}.navbar{--bs-navbar-padding-x:0;--bs-navbar-padding-y:0.5rem;--bs-navbar-color:rgba(0, 0, 0, 0.55);--bs-navbar-hover-color:rgba(0, 0, 0, 0.7);--bs-navbar-disabled-color:rgba(0, 0, 0, 0.3);--bs-navbar-active-color:rgba(0, 0, 0, 0.9);--bs-navbar-brand-padding-y:0.3125rem;--bs-navbar-brand-margin-end:1rem;--bs-navbar-brand-font-size:1.25rem;--bs-navbar-brand-color:rgba(0, 0, 0, 0.9);--bs-navbar-brand-hover-color:rgba(0, 0, 0, 0.9);--bs-navbar-nav-link-padding-x:0.5rem;--bs-navbar-toggler-padding-y:0.25rem;--bs-navbar-toggler-padding-x:0.75rem;--bs-navbar-toggler-font-size:1.25rem;--bs-navbar-toggler-icon-bg:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%280, 0, 0, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");--bs-navbar-toggler-border-color:rgba(0, 0, 0, 0.1);--bs-navbar-toggler-border-radius:0.375rem;--bs-navbar-toggler-focus-width:0.25rem;position:relative;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;padding:var(--bs-navbar-padding-y) var(--bs-navbar-padding-x)}.navbar>.container,.navbar>.container-fluid{display:flex;flex-wrap:inherit;align-items:center;justify-content:space-between}.navbar-brand{padding-top:var(--bs-navbar-brand-padding-y);padding-bottom:var(--bs-navbar-brand-padding-y);margin-right:var(--bs-navbar-brand-margin-end);font-size:var(--bs-navbar-brand-font-size);color:var(--bs-navbar-brand-color);text-decoration:none;white-space:nowrap}.navbar-nav{--bs-nav-link-padding-x:0;--bs-nav-link-padding-y:0.5rem;--bs-nav-link-font-weight: ;--bs-nav-link-color:var(--bs-navbar-color);--bs-nav-link-hover-color:var(--bs-navbar-hover-color);--bs-nav-link-disabled-color:var(--bs-navbar-disabled-color);display:flex;flex-direction:column;padding-left:0;margin-bottom:0;list-style:none}.navbar-collapse{flex-basis:100%;flex-grow:1;align-items:center}.navbar-toggler{padding:var(--bs-navbar-toggler-padding-y) var(--bs-navbar-toggler-padding-x);font-size:var(--bs-navbar-toggler-font-size);line-height:1;color:var(--bs-navbar-color);background-color:rgba(0,0,0,0);border:var(--bs-border-width) solid var(--bs-navbar-toggler-border-color);border-radius:var(--bs-navbar-toggler-border-radius)}.navbar-toggler-icon{display:inline-block;width:1.5em;height:1.5em;vertical-align:middle;background-image:var(--bs-navbar-toggler-icon-bg);background-repeat:no-repeat;background-position:center;background-size:100%}@media (min-width:992px){.navbar-expand-lg{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-lg .navbar-nav{flex-direction:row}.navbar-expand-lg .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-lg .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-lg .navbar-toggler{display:none}}.navbar-dark{--bs-navbar-color:rgba(255, 255, 255, 0.55);--bs-navbar-hover-color:rgba(255, 255, 255, 0.75);--bs-navbar-disabled-color:rgba(255, 255, 255, 0.25);--bs-navbar-active-color:#fff;--bs-navbar-brand-color:#fff;--bs-navbar-brand-hover-color:#fff;--bs-navbar-toggler-border-color:rgba(255, 255, 255, 0.1);--bs-navbar-toggler-icon-bg:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e")}.breadcrumb{--bs-breadcrumb-padding-x:0;--bs-breadcrumb-padding-y:0;--bs-breadcrumb-margin-bottom:1rem;--bs-breadcrumb-bg: ;--bs-breadcrumb-border-radius: ;--bs-breadcrumb-divider-color:#6c757d;--bs-breadcrumb-item-padding-x:0.5rem;--bs-breadcrumb-item-active-color:#6c757d;display:flex;flex-wrap:wrap;padding:var(--bs-breadcrumb-padding-y) var(--bs-breadcrumb-padding-x);margin-bottom:var(--bs-breadcrumb-margin-bottom);font-size:var(--bs-breadcrumb-font-size);list-style:none;background-color:var(--bs-breadcrumb-bg);border-radius:var(--bs-breadcrumb-border-radius)}.breadcrumb-item+.breadcrumb-item{padding-left:var(--bs-breadcrumb-item-padding-x)}.breadcrumb-item+.breadcrumb-item::before{float:left;padding-right:var(--bs-breadcrumb-item-padding-x);color:var(--bs-breadcrumb-divider-color);content:var(--bs-breadcrumb-divider, "/")}.breadcrumb-item.active{color:var(--bs-breadcrumb-item-active-color)}.d-block{display:block!important}.d-none{display:none!important}.me-auto{margin-right:auto!important}.mb-2{margin-bottom:.5rem!important}.pb-4{padding-bottom:1.5rem!important}.bg-dark{--bs-bg-opacity:1;background-color:rgba(var(--bs-dark-rgb),var(--bs-bg-opacity))!important}@media (min-width:576px){.d-sm-block{display:block!important}}@media (min-width:768px){.justify-content-md-center{justify-content:center!important}}@media (min-width:992px){.d-lg-block{display:block!important}.d-lg-none{display:none!important}.mb-lg-0{margin-bottom:0!important}}a{text-decoration:none}.station h1,h1,h2,h3{padding:1.25rem 0}h1{font-size:1.55rem}h2{font-size:1.25rem}h3{font-size:1.2rem}a{color:#386228}.cntnl a{font-weight:600}.imagem-lcp{display:block;width:100%;height:auto;aspect-ratio:1024/538;object-fit:cover}.page-title-mini-1{position:relative;padding:20px 0;border-bottom:1px solid #eee}.breadcrumb,.page-title-mini-1 .breadcrumb{position:absolute!important;width:auto!important;top:50%!important;left:auto!important;margin:-10px 0 0!important;background-color:transparent!important;padding:0!important;font-size:12px}.page-title-mini-1 .breadcrumb{right:auto!important}.breadcrumb{right:15px!important}.breadcrumb-item+.breadcrumb-item::before{content:"•"}.station h1{font-size:1.5rem;margin:0}.station h2,.station h3{padding-bottom:.5rem}#bxi-search{z-index:1;background-color:#222}.ctxtpqc{min-width:370px}.risearch{padding:10px 0 1px}.cont_ads_pcht{text-align:center}#fsearchm{padding-top:8px}.uppercase{text-transform:uppercase}.post-info{border-top:1px solid #ddd;border-bottom:1px solid #ddd;font-size:13px}@media (max-width:321px){.navbar-brand img{width:165px!important;height:37px!important}}@media (max-width:375px){.navbar-brand img{width:205px;height:46px}}@media (max-width:575.98px){#bxi-search{border-top:1px solid #9a9d9e}}.cont_ads_pcht{width:100%;margin-top:40px;margin-bottom:30px;min-height:150px}.ads_pcht{width:100%;min-height:280px}@media (min-width:1200px){.ads_pcht{max-width:1140px;min-height:280px}}</style><link rel="canonical" href="https://precocombustiveis.pt/proxima-semana/"/><meta name="robots" content="max-image-preview:large"><meta name="description" content="Consulte o preço dos combustíveis para a próxima semana em Portugal. Descubra as variações do gasóleo e gasolina, com previsões atualizadas!"><meta property="og:title" content="Preço dos Combustíveis na próxima semana (1 a 7 de setembro)"/><meta property="og:description" content="Consulte o preço dos combustíveis para a próxima semana em Portugal. Descubra as variações do gasóleo e gasolina, com previsões atualizadas!"/><meta property="og:url" content="https://precocombustiveis.pt/proxima-semana/"/><meta property="og:locale" content="pt_PT" /><meta property="og:site_name" content="Preço dos Combustíveis"/><meta property="og:image" content="https://precocombustiveis.pt/templates/assets/site/images/sh/combustiveis-proxima-semana.jpg"/><link rel="image_src" href="https://precocombustiveis.pt/templates/assets/site/images/sh/combustiveis-proxima-semana.jpg"/><meta property="og:image:alt" content="Preço dos combustíveis para a próxima semana"/><link rel="apple-touch-icon" sizes="180x180" href="https://precocombustiveis.pt/templates/assets/site/images/icons/manifest-icon-192.maskable.png"><link rel="shortcut icon" type="image/png" sizes="32x32" href="https://precocombustiveis.pt/templates/assets/site/images/icons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="32x32" href="https://precocombustiveis.pt/templates/assets/site/images/icons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://precocombustiveis.pt/templates/assets/site/images/icons/favicon-16x16.png"><link rel="mask-icon" href="https://precocombustiveis.pt/templates/assets/site/images/icons/safari-pinned-tab.svg" color="#56983d"><meta name="msapplication-TileColor" content="#56983d"><meta name="theme-color" content="#56983d"><meta name="apple-mobile-web-app-status-bar-style" content="#56983d"><meta name="mobile-web-app-capable" content="yes" /><meta name="apple-touch-fullscreen" content="yes" /><meta name="apple-mobile-web-app-title" content="Preço dos Combustíveis" /><meta name="apple-mobile-web-app-capable" content="yes" /><link rel="manifest" href="https://precocombustiveis.pt/manifest.json?1"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2048-2732.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2732-2048.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1668-2388.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2388-1668.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1536-2048.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2048-1536.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1668-2224.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2224-1668.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1620-2160.png" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2160-1620.png" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1290-2796.png" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2796-1290.png" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1179-2556.png" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2556-1179.png" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1284-2778.png" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2778-1284.png" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1170-2532.png" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2532-1170.png" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1125-2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2436-1125.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1242-2688.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2688-1242.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-828-1792.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1792-828.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1242-2208.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-2208-1242.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-750-1334.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1334-750.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-640-1136.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"><link rel="apple-touch-startup-image" href="https://precocombustiveis.pt/templates/assets/site/images/startup/apple-splash-1136-640.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"><link rel="stylesheet" href="https://precocombustiveis.pt/templates/assets/site/css/custom.css?1.0.4" media="print" onload="this.media='all'"> <noscript><link rel="stylesheet" href="https://precocombustiveis.pt/templates/assets/site/css/custom.css?1.0.4"></noscript><link rel="stylesheet" href="https://precocombustiveis.pt/templates/assets/site/css/pc.min.css?1.1.50" media="print" onload="this.media='all'"> <noscript><link rel="stylesheet" href="https://precocombustiveis.pt/templates/assets/site/css/pc.min.css?1.1.50"></noscript> <script type="application/ld+json">
    {"@context":"https:\/\/schema.org","@graph":[{"@context":"http:\/\/schema.org","@type":"NewsArticle","@id":"https:\/\/precocombustiveis.pt\/proxima-semana\/#newsarticle","name":"Preço dos combustíveis na próxima semana (1 a 7 de setembro)","description":"Consulte o preço dos combustíveis para a próxima semana em Portugal. Descubra as variações do gasóleo e gasolina, com previsões atualizadas!","headline":"Preço dos combustíveis na próxima semana (1 a 7 de setembro)","thumbnailUrl":"https:\/\/precocombustiveis.pt\/templates\/assets\/site\/images\/sh\/combustiveis-proxima-semana.jpg","datePublished":"2025-08-29T11:37:56+0100","dateModified":"2025-08-29T11:37:56+0100","articleSection":"Combustíveis Próxima Semana","author":{"@context":"http:\/\/schema.org","@id":"https:\/\/precocombustiveis.pt\/#author","@type":"Person","name":"Preço dos Combustíveis"},"publisher":{"@id":"https:\/\/precocombustiveis.pt\/#organization"},"image":{"@context":"http:\/\/schema.org","@type":"ImageObject","url":"https:\/\/precocombustiveis.pt\/templates\/assets\/site\/images\/sh\/combustiveis-proxima-semana.jpg","width":"1200","height":"630","contentUrl":"https:\/\/precocombustiveis.pt\/templates\/assets\/site\/images\/sh\/combustiveis-proxima-semana.jpg","creditText":"Preço dos Combustíveis"},"inLanguage":"pt-PT","mainEntityOfPage":{"@id":"https:\/\/precocombustiveis.pt\/proxima-semana\/#webpage"},"url":"https:\/\/precocombustiveis.pt\/proxima-semana\/","isPartOf":{"@id":"https:\/\/precocombustiveis.pt\/proxima-semana\/#webpage"},"isAccessibleForFree":true,"isFamilyFriendly":true},{"@type":"WebPage","@id":"https:\/\/precocombustiveis.pt\/proxima-semana\/#webpage","url":"https:\/\/precocombustiveis.pt\/proxima-semana\/","name":"Preço dos combustíveis na próxima semana (1 a 7 de setembro)","datePublished":"2025-08-29T11:37:56+0100","dateModified":"2025-08-29T11:37:56+0100","isPartOf":{"@id":"https:\/\/precocombustiveis.pt\/proxima-semana\/#webpage"},"primaryImageOfPage":{"@id":"https:\/\/precocombustiveis.pt\/templates\/assets\/site\/images\/sh\/combustiveis-proxima-semana.jpg"},"inLanguage":"pt-PT"},{"@type":"Organization","@id":"https:\/\/precocombustiveis.pt\/#organization","name":"Preço dos Combustíveis","url":"https:\/\/precocombustiveis.pt\/","logo":{"@type":"ImageObject","@id":"https:\/\/precocombustiveis.pt\/#organizationLogo","url":"https:\/\/precocombustiveis.pt\/templates\/assets\/site\/images\/icons\/manifest-icon-512.maskable.png","width":"512","height":"512"},"image":{"@id":"https:\/\/precocombustiveis.pt\/#organizationLogo"},"sameAs":["https:\/\/www.facebook.com\/precocombustiveis.pt","https:\/\/www.instagram.com\/precocombustiveis.pt"]},{"@type":"WebSite","@id":"https:\/\/precocombustiveis.pt\/#website","url":"https:\/\/precocombustiveis.pt\/","name":"Preço dos Combustíveis","alternateName":"PrecoCombustiveis.pt","publisher":{"@id":"https:\/\/precocombustiveis.pt\/#organization"},"potentialAction":{"@type":"SearchAction","target":"https:\/\/precocombustiveis.pt\/pesquisa\/?q={search_term_string}","query-input":"required name=search_term_string"},"inLanguage":"pt-PT"}]}</script> <script type="text/javascript">
    if('serviceWorker'in navigator){try{var serviceWorkUrl='https://precocombustiveis.pt/sw.js?9';window.addEventListener('load',function(){navigator.serviceWorker.register(serviceWorkUrl).then(function(registration){console.log('ServiceWorker registration successful with scope: ',registration.scope);}).catch(function(err){console.log('ServiceWorker registration failed: ',err);});});window.addEventListener('appinstalled',(e)=>{console.log('appinstalled');});let deferredPrompt;window.addEventListener('beforeinstallprompt',(e)=>{e.preventDefault();deferredPrompt=e;console.log('saved the install event',deferredPrompt);showInAppInstallPromotion();});}catch(err){console.log('ServiceWorker registration failed: ',err);}}</script> </head><body> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMCDDJV"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <header role="banner"> <nav class="navbar navbar-expand-lg navbar-dark bg-dark" aria-label="Preço dos Combustíveis"><div class="container"> <a class="navbar-brand" href="https://precocombustiveis.pt/"><img title="Preço dos Combustíveis - Comparador de Preços em Portugal" alt="Preço dos Combustíveis - Comparador de Preços em Portugal" src="https://precocombustiveis.pt/templates/assets/site/images/logo-w-md.png" width="224" height="50" fetchpriority="high"/></a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsPC" aria-controls="navbarsPC" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button><div class="collapse navbar-collapse justify-content-md-center" id="navbarsPC"><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item"> <a class="nav-link active*" aria-current="page" href="https://precocombustiveis.pt/">Início</a></li><li class="nav-item"> <a class="nav-link" href="https://precocombustiveis.pt/preco-combustiveis/">Postos por concelho</a></li><li class="nav-item"> <a class="nav-link" href="https://precocombustiveis.pt/combustivel/mais-barato/">Postos mais baratos</a><li><li class="nav-item"> <a class="nav-link" href="https://precocombustiveis.pt/mapa/">Mapa de Postos</a><li><li class="nav-item"> <a class="nav-link" href="https://precocombustiveis.pt/blog/">Blog</a></li></ul><div class="d-none d-lg-block"><form role="search" action="https://precocombustiveis.pt/pesquisa/"> <input class="form-control ctxtpqc" type="text" name="q" id="txtpqc" placeholder="Pesquise por posto, localidade ou cód. postal." aria-label="Insira o posto ou localidade" minlength="3"></form></div></div></div><form action="https://precocombustiveis.pt/pesquisa/" id="fsearchm" class="container-fluid d-block d-lg-none"><div class="container* container-fluid* in* bg-dark collapse*" id="bxi-search" style=""><div class="container"><div class="row risearch"><div class="col-12"> <input type="text" name="q" id="txtpqc1" placeholder="Pesquise por posto, localidade ou cód. postal." class="form-control" minlength="3"></div></div></div></div></form> </nav> </header><div class="container station"><div class="page-title-mini-1 d-none d-sm-block"> <nav aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="https://precocombustiveis.pt">Início</a></li><li class="breadcrumb-item active" aria-current="page"><a href="https://precocombustiveis.pt/proxima-semana/">Preço dos combustíveis na próxima semana (1 a 7 de setembro)</a></li></ol> </nav></div> <main class="pb-4"><div class="row"><div class="dal col-12 col-lg cntnl"> <article class="blog-post"> <header><h1>Preço dos combustíveis na próxima semana (1 a 7 de setembro)</h1><p class="uppercase post-info">Atualizado a 29 de Agosto de 2025 ‧ Por Preço dos Combustíveis</p><p>O <a href="https://precocombustiveis.pt">preço dos combustíveis</a> para a próxima semana de 1 a 7 de setembro em Portugal continental, apresentam uma tendência de subida no Gasóleo e tendência de descida na Gasolina. <strong>O Gasóleo deverá subir até 0,5 cêntimos (0,005 euros/litro) e a Gasolina deverá descer até -0,5 cêntimos (-0,005 euros/litro)</strong> de acordo com a imprensa especializada do setor.</p><div class="cont_ads_pcht"> <ins class="adsbygoogle ads_pcht"
    style="display:block"
    data-ad-client="ca-pub-1308566387479814"
    data-ad-slot="6732810138"
    data-ad-format="auto"
    data-full-width-responsive="true"></ins></div> <figure class="img-fluid"> <picture> <source srcset="https://precocombustiveis.pt/templates/assets/site/images/sh/preco-combustiveis-proxima-semana.webp" type="image/webp" media="(min-width: 768px)"> <source srcset="https://precocombustiveis.pt/templates/assets/site/images/sh/combustiveis-proxima-semana.jpg" type="image/jpeg" media="(min-width: 768px)"> <source srcset="https://precocombustiveis.pt/templates/assets/site/images/sh/combustiveis-proxima-semana-640.webp" type="image/webp" media="(max-width: 767px)"> <source srcset="https://precocombustiveis.pt/templates/assets/site/images/sh/combustiveis-proxima-semana-640.jpg" type="image/jpeg" media="(max-width: 767px)"> <img src="https://precocombustiveis.pt/templates/assets/site/images/sh/combustiveis-proxima-semana.jpg"
    width="1200" height="630" class="imagem-lcp img-fluid" alt="Preco combustiveis proxima semana Portugal" title="Previsão dos combustíveis próxima semana" loading="eager" fetchpriority="high" decoding="async"> </picture> <figcaption>Previsão semanal dos preços da gasolina e gasóleo para a próxima semana (1 a 7 de setembro)</figcaption> </figure> </header><h2>Qual o preço médio dos combustiveis na proxima semana?</h2><p>Assim, e a partir de segunda-feira (1 de setembro), quando for abastecer a sua viatura irá passar a pagar 1.55 euros por litro de gasóleo simples e 1.692 euros por litro de gasolina simples 95, tendo em conta os valores médios praticados nas bombas na última segunda-feira, divulgados pela <a class="loader" href="https://precoscombustiveis.dgeg.gov.pt/estatistica/preco-medio-diario/" target="_blank" rel="noopener">Direção-Geral de Energia e Geologia (DGEG)</a>, e que já têm em conta os descontos aplicados pelas gasolineiras.</p><h2>Quanto sobe ou desce o gasoleo para a semana que vem?</h2><p>O <a href="https://precocombustiveis.pt/gasoleo/">preço do litro de gasóleo</a> deverá subir até 0,5 cêntimos (0,005 euros/litro)</p><h2>Quanto sobe ou desce a gasolina para a semana que vem?</h2><p>O <a href="https://precocombustiveis.pt/gasolina/">preço do litro de gasolina</a> deverá descer até -0,5 cêntimos (-0,005 euros/litro)</p><p>Relembramos que cada posto de abastecimento de combustível é livre de definir o seu próprio preço.</p><p>Veja o <a href="https://precocombustiveis.pt/combustivel/mais-barato/">preço dos combustiveis mais baratos por marca e ou concelho aqui</a>.</p><p>Pode consultar o <a href="https://precocombustiveis.pt/madeira/">preço dos combustíveis Madeira para a semana que vem.</a></p><div class="card mt-4 mb-2 p-3 bg-dark shadow"><p class="card-desc-p text-white line-height-3 text-left">Receba os Postos de Combustíveis mais baratos perto de si no seu e-mail.</p><p class="text-white">Pode escolher até 3 concelhos com os Postos Mais Baratos!</p><div class="row"><div class="col-12 col-md"> <button type="button" class="btqrnews btn btn-primary text-white shadow bg-gradient" id="btOPP">Sim, Quero receber!</button></div></div></div><div class="col-12 mb-4"><h2>Análise da evolução do preço dos combustíveis nas últimas semanas</h2><div id="chart_div"><div class="centerDiv">A carregar gráfico...</div></div><h3>Fatores que influenciaram as flutuações de preços</h3><p>Vários fatores internos e externos contribuíram para as recentes oscilações de preços:</p><ul><li><strong>Custo de refinação:</strong> O aumento nas despesas operacionais das refinarias, como energia, refletiu-se nos preços ao consumidor.</li><li><strong>Impostos e taxas:</strong> Alterações nas políticas fiscais influenciaram os custos finais. Estas mudanças incluíram ajustes no Imposto sobre produtos petrolíferos (ISP), impactando os preços de forma generalizada.</li><li><strong>Tensões geopolíticas:</strong> Incidentes no Médio Oriente e decisões da OPEP sobre os níveis de produção criaram incertezas no mercado global.</li></ul></div><h2>Metodologia de cálculo dos preços dos combustíveis para a próxima semana</h2><p>Calcular os preços dos combustíveis é um processo complexo que envolve muitas variáveis. Essas variáveis não são apenas importantes economicamente, mas também são altamente relevantes para o nosso quotidiano, desde a nossa capacidade de deslocação até ao impacto dessa mobilidade no meio ambiente. De seguida, vamos explicar esta fórmula complexa para ajudá-lo a entender melhor o que está por trás do preço do combustível sempre que vai abastecer.</p><p>Vamos começar com os fatores que compõem a maior percentagem nos preços de combustíveis.
    Os Imposto. Em Portugal, o Estado fixa cerca de 60% do preço final do combustível pago pelos consumidores. Isto deve-se principalmente ao imposto sobre os produtos energéticos petrolíferos (famoso ISP) e ao imposto sobre o valor acrescentado (IVA). O ISP é um imposto específico cobrado sobre o consumo de petróleo e os seus derivados. O IVA é um imposto geral cobrado sobre todas as transações comerciais, incluindo a venda de combustível. Ambos são adicionados ao preço base do combustível para dar ao consumidor final o preço que se paga na bomba.</p><p>O valor base do combustível é determinado por muitos fatores. O primeiro, e talvez o mais importante, é o preço internacional do petróleo. A cotação internacional é monitorizada diariamente e afeta diretamente o valor base do combustível. Mudanças na oferta e procura, instabilidade política em países produtores de petróleo e outros fatores macroeconómicos podem fazer com que esses preços flutuem significativamente.</p><p>O custo do transporte de petróleo para Portugal também é uma parte importante do valor base do combustível. Somados aos abastecimentos internacionais, esses custos de transporte representam quase 30% do preço final do combustível. A obrigatoriedade de incorporação de biocombustíveis também deve ser considerada. Como parte dos esforços para reduzir as emissões de gases de efeito estufa, os estados estão obrigados a reforçar a percentagem de biocombustíveis nos combustíveis. As percentagens de incorporação são determinadas anualmente pelos países de acordo com as metas da União Europeia. Em Portugal a entidade responsável é a <a target="_blank" rel="noopener" href="https://www.ense-epe.pt">Entidade Nacional para o Setor Energético</a> (ENSE).</p><p>Outro fator a considerar são as reservas estratégicas de petróleo e derivados geridas pela ENSE. Os custos de gestão e armazenamento destas reservas, a descarga e armazenamento de produtos petrolíferos refletem-se nos preços dos combustíveis, bem como os custos de comercialização e margens comerciais.</p><h2>Perguntas frequentes sobre o preço dos combustíveis na próxima semana</h2><div itemscope itemtype="https://schema.org/FAQPage"><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"><h3 itemprop="name">Quando são atualizados os preços dos combustíveis em Portugal?</h3><div itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p itemprop="text">Em Portugal, os preços dos combustíveis são geralmente atualizados semanalmente, com as alterações a entrarem em vigor às segundas-feiras. As variações refletem as flutuações nos mercados internacionais de petróleo e outros fatores económicos.</p></div></div><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"><h3 itemprop="name">Por que o preço de combustível varia entre postos de abastecimento?</h3><div itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p itemprop="text">As variações de preço entre postos de abastecimento devem-se a fatores como políticas de preços das empresas, localização geográfica, concorrência local e custos operacionais específicos de cada posto.</p></div></div></div><p class="pt-4">Aproveite para ler o artigo <a href="https://precocombustiveis.pt/dicas-para-poupar-combustivel-ao-abastecer-idbsty4dh64/">6 Dicas para poupar combustível ao abastecer</a></p> </article></div> <aside class="dar col-12 col-xl-3 lrlblog"> <ins class="adsbygoogle"
    style="display:block"
    data-ad-client="ca-pub-1308566387479814"
    data-ad-slot="3912077235"
    data-ad-format="auto"
    data-full-width-responsive="true"></ins> </aside></div> </main></div> <footer class="copyright" itemscope itemtype="https://schema.org/Organization"><div class="container"><div class="row"><div class="col"><div class="pl-2 text-muted copyright-bd"> © 2025 Todos os direitos reservados - <a href="https://precocombustiveis.pt/" itemprop="url"><span itemprop="name">Preço dos Combustíveis</span></a></div></div><div class="col-12"><div class="copyright-menu text-left"><ul><li> <a href="https://precocombustiveis.pt/" >Início</a></li><li> <span class="dot">•</span> <a href="https://precocombustiveis.pt/sobre-nos/" >Sobre Nós</a></li><li> <span class="dot">•</span> <a href="https://precocombustiveis.pt/politica-privacidade/" rel="nofollow">Política de Privacidade</a></li><li> <span class="dot">•</span> <a href="https://precocombustiveis.pt/widget/" >Widget</a></li><li> <span class="dot">•</span> <a href="https://precocombustiveis.pt/contato/" >Contacto</a></li></ul></div></div><p class="small text-muted mt-3"> Preço dos Combustíveis é o comparador português que ajuda milhares de condutores a encontrar os melhores preços de gasolina, gasóleo e GPL perto de si.</p></div></div> </footer> <script type="text/javascript">
    (function carregarAdSense(){const script=document.createElement('script');script.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1308566387479814";script.async=true;script.crossOrigin="anonymous";script.onload=function(){ativarImediatos();ativarLazy();};document.head.appendChild(script);})();function ativarImediatos(){const blocos=document.querySelectorAll('ins.adsbygoogle:not(.lazy-ad)');blocos.forEach(initAd);}
    function ativarLazy(){const blocos=document.querySelectorAll('ins.adsbygoogle.lazy-ad');if(!('IntersectionObserver'in window)){blocos.forEach(initAd);return;}
    const observer=new IntersectionObserver(function(entries,observer){entries.forEach(function(entry){if(entry.isIntersecting){initAd(entry.target);observer.unobserve(entry.target);}});},{rootMargin:'0px 0px 200px 0px',threshold:0.01});blocos.forEach(bloco=>observer.observe(bloco));}
    function initAd(element){if(element.getAttribute('data-adsbygoogle-status')==='done'){return;}
    try{(adsbygoogle=window.adsbygoogle||[]).push({});}catch(e){console.warn("❌ Erro ao carregar anúncio:",e);}}</script> <script type="text/javascript" src="https://precocombustiveis.pt/templates/assets/site/js/jquery-3.6.1.min.js" defer></script> <script type="text/javascript" src="https://precocombustiveis.pt/templates/assets/site/js/bootstrap.min.js" crossorigin="anonymous" defer></script> <script>
    window.lazyLoadOptions={};</script> <script async defer src="https://precocombustiveis.pt/templates/assets/common/lazyload/lazyload.min.js"></script> <script type="text/javascript" src="https://precocombustiveis.pt/templates/assets/site/js/pc.min.js?1.0.53" defer></script> <script type="text/javascript">
    (function waitForChartDiv(){const chartElement=document.getElementById('chart_div');if(chartElement){if('IntersectionObserver'in window){const observer=new IntersectionObserver((entries,observer)=>{if(entries[0].isIntersecting){load_chart_js();observer.disconnect();}});observer.observe(chartElement);}else{load_chart_js();}}else{setTimeout(waitForChartDiv,500);}})();function load_chart_js(){var js_scripts=["https://www.gstatic.com/charts/loader.js"];getScripts(js_scripts,function(){load_chart_data();},function(url){});}
    function load_chart_data(){google.charts.load('current',{packages:['corechart']});google.charts.setOnLoadCallback(drawBackgroundColor);}
    function drawBackgroundColor(){var data=new google.visualization.DataTable();data.addColumn('string','Dia');data.addColumn('number','Gasóleo Simples');data.addColumn('number','Gasolina 95');data.addRows([['23/06',1.602,1.715],['30/06',1.577,1.694],['07/07',1.573,1.675],['14/07',1.604,1.690],['21/07',1.599,1.689],['28/07',1.593,1.681],['04/08',1.588,1.704],['11/08',1.559,1.696],['18/08',1.540,1.692],['25/08',1.545,1.697],]);var options={chartArea:{top:25,right:10,left:35,bottom:35,width:"90%",height:"80%"},legend:{position:"top",maxLines:9,alignment:'center'},hAxis:{textStyle:{fontSize:10,}},vAxis:{textStyle:{fontSize:11,}},interpolateNulls:true,pointSize:3,'height':350,'colors':['#000000','#C8D11B',]};var chart=new google.visualization.LineChart(document.getElementById('chart_div'));chart.draw(data,options);$(window).on('resize',function(){chart.draw(data,options);});}
    function getScripts(scripts,success_callback,fail_callback){if(scripts.length>0){$.getScript(scripts[0]).done(function(script,textStatus){scripts.shift();getScripts(scripts,success_callback,fail_callback);}).fail(function(jqxhr,settings,exception){fail_callback(scripts[0]);});}else{success_callback();}}</script> <script type="text/javascript">
    window.OneSignal=window.OneSignal||[];OneSignal.push(function(){OneSignal.init({appId:"cc339e49-9dfc-4f0d-8a5f-4c81d4b8f31a",});});</script> <script type="text/javascript">
    var url_s='https://precocombustiveis.pt';document.addEventListener("DOMContentLoaded",()=>{let scriptAD=document.createElement('script');scriptAD.src='https://platform-api.sharethis.com/js/sharethis.js#property=6856d14e52cb3a001af405b4&product=sharing-intelligence';document.body.appendChild(scriptAD);let scriptOS=document.createElement('script');scriptOS.src='https://cdn.onesignal.com/sdks/OneSignalSDK.js';document.body.appendChild(scriptOS);});</script> <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'977d28f63a171c16',t:'MTc1NjY0OTkzNg=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body></html><!-- 01:06:31, 31-08-2025 55655.44554 -->
    """
    fuel_type = "gasolina"
    result = extract_variation(html, fuel_type)
    assert result["tendencia"] == "desce"
    assert result["variacao"] == -0.5


def test_parse_variation_subida():
    text = "O preço do litro de gasóleo deverá subir até 0,5 cêntimos (0,005 euros/litro)"
    result = parse_variation(text)
    assert result["tendencia"] == "sobe"
    assert result["variacao"] == 0.5


def test_parse_variation_descida():
    text = "O preço do litro de gasolina deverá descer até -0,5 cêntimos (-0,005 euros/litro)"
    result = parse_variation(text)
    assert result["tendencia"] == "desce"
    assert result["variacao"] == -0.5


def test_parse_variation_neutro():
    text = "O preço do litro de gasolina deverá manter-se estável"
    result = parse_variation(text)
    assert result["tendencia"] == "neutro"
    assert result["variacao"] is None
